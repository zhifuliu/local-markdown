<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>网络收藏</title>
    <link rel="stylesheet" href="css.css">
    <script src="scripts.js"></script>
</head>
<body>
<!-- header -->
<div class="header" data-bind="visible: currentUser()">
    <li class="siteName f-26">收藏您喜欢的任何东西</li>
    <div class="search">
        <input class="item" type="text" data-bind="textInput: searchStr, event: {keydown: keySearch}">
        <button class="item" data-bind="click: publishSearch">搜索</button>
    </div>

    <span class="m-dropdown">
            <b class="title" data-toggle="dropdown" data-bind="text: currentUser() ? currentUser().nickname : '请登录'"></b>
            <ul class="dropdown-menu">
                <li class="item">
                    <a data-bind="click: showChangePass">
                        <i class="icon"></i>修改密码
                    </a>
                </li>
                <li class="item">
                    <a data-bind="click: showChangeNick">
                        <i class="icon"></i>修改昵称
                    </a>
                </li>
                <li class="item">
                    <a data-bind="click: showChangeOneLevelTags">
                        <i class="icon"></i>一级标签
                    </a>
                </li>
                <li class="item">
                    <a data-bind="click: showChangeTags">
                        <i class="icon"></i>二级标签
                    </a>
                </li>
                <li class="item">
                    <a data-bind="click: logout">
                        <i class="icon"></i>注销账户
                    </a>
                </li>
            </ul>
          </span>
</div>

<div class="content">
    <div class="left" data-bind="css: {openCollect: currentCollect() != null && !isEditing()}">
        <div data-bind="component: { name: route().page, params: route }"></div>
    </div>
    <div class="center" data-bind="css: {openCollect: currentCollect() != null && !isEditing()}">
        <div class="close-btn" data-bind="click: function(){currentCollect(null);}">x</div>
        <!-- ko if: currentCollect() != null -->
        <table>
            <tbody>
                <tr data-bind="visible: !contentIsEmpty(currentCollect().title)">
                    <td>标题:</td>
                    <td><a data-bind="text: currentCollect().title, attr:{href: currentCollect().url}" target="_blank"></a></td>
                </tr>
                <tr data-bind="visible: !contentIsEmpty(currentCollect().oneLevelTag) && !contentIsEmpty(currentCollect().twoLevelTag)">
                    <td>标签:</td>
                    <td data-bind="text: currentCollect().oneLevelTag + '--' + currentCollect().twoLevelTag"></td>
                </tr>
                <tr data-bind="visible: !contentIsEmpty(currentCollect().remark)">
                    <td>备注:</td>
                    <td data-bind="text: currentCollect().remark"></td>
                </tr>
                <tr data-bind="visible: !contentIsEmpty(currentCollect().date)">
                    <td>日期:</td>
                    <td data-bind="text: handleDate(currentCollect().date)"></td>
                </tr>
                <tr data-bind="visible: !contentIsEmpty(currentCollect().time)">
                    <td>时间:</td>
                    <td data-bind="text: handleTime(currentCollect().time)"></td>
                </tr>
            </tbody>
        </table>
        <div class="btns">
            <button class="delete-button" type="button" name="button" data-bind="click: function(){deleteId(currentCollect()._id);}">deletd</button>
            <button class="close-button" type="button" name="button" data-bind="click: function(){currentCollect(null);}">close</button>
            <button class="edit-button" type="button" name="button" data-bind="click: editcollect">edit</button>
        </div>
        <!-- /ko -->
    </div>
    <div class="right" data-bind="visible: currentUser()">
        <div class="userMsg">
            <div class="head head-img"></div>
            <div class="nickname" data-bind="text: currentUser() ? currentUser().nickname : ''"></div>
        </div>
        <div class="post-tags pd-tb10-lr5">
            <div class="tree">
                <div class="item" data-bind="css: {active: activeTag() == '全部'}, click: function(){activeTag('全部')}">
                    <div class="title-head">
                        <label class="title" data-bind="text: '全部'"></label>
                        <span class="arrow-point">></span>
                    </div>
                </div>
                <!--ko foreach: currentUser() ? currentUser().tags.oneLevelTags : [] -->
                    <div class="item" data-bind="css: {active: $parents[0].activeTag() == $data.name}">
                        <div class="title-head" data-bind="click: function(){$parents[0].activeTag($data.name)}">
                            <label class="title" data-bind="text: $data.name"></label>
                            <span class="arrow-point">></span>
                        </div>
                        <ul>
                            <li data-bind="text: '全部', click: function(){$parents[0].activeTwoTag('全部')}, css: {active: $parents[0].activeTwoTag() == '全部'}"></li>
                            <!-- ko foreach: $data.tags -->
                            <li data-bind="text: $data, click: function(){$parents[1].activeTwoTag($data)}, css: {active: $parents[1].activeTwoTag() == $data}"></li>
                            <!-- /ko -->
                        </ul>
                    </div>
                <!-- /ko -->
            </div>
        </div>
    </div>
</div>

<!-- footer -->
<div class="footer" data-bind="visible: currentUser()">
    <div class="copyright">
        <table>
            <tr>
                <td style="color: #aaaaaa">
                    <div class="msg">网络收藏网页版 © 2016</div>
                    <div class="msg">作者: 刘志付</div>
                </td>
            </tr>
        </table>
    </div>
</div>
</body>
</html>
